<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StethoLink AI - Medical Learning Assistant</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest-new.json">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/icons/icon-192x192.svg">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="StethoLink AI">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#667eea">
    <meta name="mobile-web-app-capable" content="yes">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h2>StethoLink AI</h2>
            <p>Initializing medical learning assistant...</p>
        </div>
    </div>

    <!-- Authentication Container -->
    <div id="authContainer" class="auth-container hidden">
        <div class="auth-card">
            <div class="auth-header">
                <div class="logo">
                    <i class="fas fa-stethoscope"></i>
                    <h1>StethoLink AI</h1>
                </div>
                <p>Your intelligent medical learning companion</p>
            </div>

            <!-- Login Form -->
            <form id="loginForm" class="auth-form">
                <h2>Welcome Back</h2>
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" required placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" required placeholder="Enter your password">
                </div>
                <button type="submit" class="btn-primary">
                    <i class="fas fa-sign-in-alt"></i>
                    Sign In
                </button>
                <p class="auth-switch">
                    Don't have an account? 
                    <a href="#" id="showRegister">Sign up</a>
                </p>
            </form>

            <!-- Register Form -->
            <form id="registerForm" class="auth-form hidden">
                <h2>Create Account</h2>
                <div class="form-group">
                    <label for="registerName">Full Name</label>
                    <input type="text" id="registerName" required placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" required placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="registerPassword">Password</label>
                    <input type="password" id="registerPassword" required placeholder="Create a password">
                </div>
                <div class="form-group">
                    <label for="registerLanguage">Preferred Language</label>
                    <select id="registerLanguage" required>
                        <option value="en">English</option>
                        <option value="si">‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω (Sinhala)</option>
                        <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç (Tamil)</option>
                    </select>
                </div>
                <button type="submit" class="btn-primary">
                    <i class="fas fa-user-plus"></i>
                    Create Account
                </button>
                <p class="auth-switch">
                    Already have an account? 
                    <a href="#" id="showLogin">Sign in</a>
                </p>
            </form>
        </div>
    </div>

    <!-- Main Application Container -->
    <div id="appContainer" class="app-container hidden">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-stethoscope"></i>
                    <h1>StethoLink AI</h1>
                </div>
            </div>
            <div class="header-center">
                <div class="user-status">
                    <span class="status-indicator online"></span>
                    <span class="status-text">Online</span>
                </div>
            </div>
            <div class="header-right">
                <div class="user-menu">
                    <button id="userMenuBtn" class="user-menu-btn">
                        <i class="fas fa-user-circle"></i>
                        <span id="userDisplayName">User</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div id="userDropdown" class="user-dropdown hidden">
                        <a href="#" id="profileLink">
                            <i class="fas fa-user"></i>
                            Profile
                        </a>
                        <a href="#" id="settingsLink">
                            <i class="fas fa-cog"></i>
                            Settings
                        </a>
                        <a href="#" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i>
                            Logout
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Sidebar -->
            <aside class="app-sidebar">
                <nav class="sidebar-nav">
                    <a href="#" class="nav-item active" data-section="chat">
                        <i class="fas fa-comments"></i>
                        <span>Chat</span>
                    </a>
                    <a href="#" class="nav-item" data-section="tasks">
                        <i class="fas fa-tasks"></i>
                        <span>Tasks</span>
                    </a>
                    <a href="#" class="nav-item" data-section="progress">
                        <i class="fas fa-chart-line"></i>
                        <span>Progress</span>
                    </a>
                    <a href="#" class="nav-item" data-section="notebook">
                        <i class="fas fa-book"></i>
                        <span>Notebook</span>
                    </a>
                    <a href="#" class="nav-item" data-section="simulations">
                        <i class="fas fa-user-md"></i>
                        <span>Simulations</span>
                    </a>
                </nav>
            </aside>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Chat Section -->
                <section id="chatSection" class="content-section active">
                    <div class="chat-container">
                        <div class="chat-header">
                            <h2>Medical Learning Assistant</h2>
                            <p>Ask me anything about medicine, practice with simulations, or get study guidance</p>
                        </div>
                        
                        <div class="chat-messages" id="chatMessages">
                            <div class="message ai-message">
                                <div class="message-avatar">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div class="message-content">
                                    <div class="message-text">
                                        Hello! I'm your StethoLink AI medical learning assistant. I can help you with:
                                        <br><br>
                                        üè• Medical diagnosis and symptoms<br>
                                        üìö Study planning and curriculum guidance<br>
                                        üéØ Practice simulations and case studies<br>
                                        üíä Drug interactions and calculations<br>
                                        üìù Note-taking and progress tracking<br><br>
                                        What would you like to learn about today?
                                    </div>
                                    <div class="message-time">Just now</div>
                                </div>
                            </div>
                        </div>

                        <div class="chat-input-container">
                            <div class="chat-input-wrapper">
                                <textarea 
                                    id="chatInput" 
                                    placeholder="Type your message here... (Press Enter to send, Shift+Enter for new line)"
                                    rows="1"
                                ></textarea>
                                <button id="sendMessageBtn" class="send-btn" disabled>
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                            <div class="chat-actions">
                                <button class="action-btn" title="Voice Message">
                                    <i class="fas fa-microphone"></i>
                                </button>
                                <button class="action-btn" title="Attach File">
                                    <i class="fas fa-paperclip"></i>
                                </button>
                                <button class="action-btn" title="Quick Actions">
                                    <i class="fas fa-bolt"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Tasks Section -->
                <section id="tasksSection" class="content-section">
                    <div class="section-header">
                        <h2>Learning Tasks</h2>
                        <button class="btn-primary" id="addTaskBtn">
                            <i class="fas fa-plus"></i>
                            Add Task
                        </button>
                    </div>
                    <div class="tasks-container" id="tasksContainer">
                        <div class="loading-placeholder">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Loading tasks...</p>
                        </div>
                    </div>
                </section>

                <!-- Progress Section -->
                <section id="progressSection" class="content-section">
                    <div class="section-header">
                        <h2>Learning Progress</h2>
                        <div class="progress-filters">
                            <select id="progressTimeframe">
                                <option value="week">This Week</option>
                                <option value="month">This Month</option>
                                <option value="year">This Year</option>
                            </select>
                        </div>
                    </div>
                    <div class="progress-container" id="progressContainer">
                        <div class="loading-placeholder">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Loading progress...</p>
                        </div>
                    </div>
                </section>

                <!-- Notebook Section -->
                <section id="notebookSection" class="content-section">
                    <div class="section-header">
                        <h2>Learning Notebook</h2>
                        <button class="btn-primary" id="addNoteBtn">
                            <i class="fas fa-plus"></i>
                            Add Note
                        </button>
                    </div>
                    <div class="notebook-container" id="notebookContainer">
                        <div class="loading-placeholder">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Loading notes...</p>
                        </div>
                    </div>
                </section>

                <!-- Simulations Section -->
                <section id="simulationsSection" class="content-section">
                    <div class="section-header">
                        <h2>Medical Simulations</h2>
                        <button class="btn-primary" id="startSimulationBtn">
                            <i class="fas fa-play"></i>
                            Start Simulation
                        </button>
                    </div>
                    <div class="simulations-container" id="simulationsContainer">
                        <div class="loading-placeholder">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Loading simulations...</p>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <div id="modalOverlay" class="modal-overlay hidden">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modalTitle">Modal Title</h3>
                <button class="modal-close" id="modalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Modal content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="app.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('‚úÖ Service Worker registered successfully:', registration);
                    })
                    .catch(error => {
                        console.log('‚ùå Service Worker registration failed:', error);
                    });
            });
        }
        
        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            console.log('üöÄ PWA Install prompt ready');
        });
        
        window.addEventListener('appinstalled', () => {
            console.log('üéâ PWA installed successfully!');
            deferredPrompt = null;
        });
    </script>
</body>
</html> 